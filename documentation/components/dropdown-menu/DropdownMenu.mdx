import { Meta, ArgTypes, Canvas, Story } from '@storybook/addon-docs/blocks';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
  DropdownMenuSeparator
} from 'src/components/dropdown-menu';
import { Button } from 'src/components/button';
import { VerticalDotsIcon, FileTextIcon } from 'src/components/icons';
import DropdownMenuStories, {CustomReference, Default} from './DropdownMenu.stories'

<Meta of={DropdownMenuStories} />

# DropdownMenu

The `DropdownMenu` component is a composable, accessible dropdown built using [Floating UI](https://floating-ui.com/) primitives. It provides flexible placement, keyboard interactions, and full control over styling and structure.

Use it to render contextual action menus triggered by buttons, icons, or any interactive element.

## Composition

The `DropdownMenu` is built from several composable parts:

- **`DropdownMenu`**: Provides context and handles positioning logic.
- **`DropdownMenuTrigger`**: Wraps the trigger element (e.g. a `Button`).
- **`DropdownMenuContent`**: Renders the floating panel containing the menu.
- **`DropdownMenuItem`**: Clickable actions or selectable options.
- **`DropdownMenuSeparator`**: Optional visual divider between sections.

## Example

<Canvas of={Default} />

## Custom Reference Element
The DropdownMenu supports advanced positioning through the triggerRef prop. This enables decoupling the visual trigger from the element used for positioning.

This is useful when:
- You want to use a floating icon, avatar, or custom area as the anchor
- You want to show the dropdown relative to one element but trigger it from another

<Canvas of={CustomReference} />


```tsx
const triggerRef = useRef(null);

return (
  <DropdownMenu
    isOpen={open}
    onOpenChange={setOpen}
    triggerRef={triggerRef}
    placement="bottom-end"
  >
    <MenuTrigger triggerRef={triggerRef} /> {/* Trigger can be elsewhere */}
    <DropdownMenuContent>
      <DropdownMenuItem onSelect={() => alert('Edit')}>Edit</DropdownMenuItem>
      <DropdownMenuItem onSelect={() => alert('Delete')}>Delete</DropdownMenuItem>
      <DropdownMenuSeparator />
      <DropdownMenuItem onSelect={() => alert('Report')}>Report</DropdownMenuItem>
    </DropdownMenuContent>
  </DropdownMenu>
);

```


---

## Accessibility

The DropdownMenu follows best practices for keyboard and screen reader support:

- Keyboard navigation: `ArrowDown`, `ArrowUp`, `Enter`, `Escape`
- aria-haspopup, aria-expanded, and aria-controls attributes on trigger
- Roles: menu, menuitem
- Focus is correctly managed when the menu opens/closes
- Screen reader-friendly structure

## Behavior & Features

- Customizable placement (bottom-start, top-end, etc.)
- Auto flips and shifts to fit viewport
- Modal or non-modal focus management
- Controlled or uncontrolled open state


## Props
<ArgTypes of={DropdownMenu} />
